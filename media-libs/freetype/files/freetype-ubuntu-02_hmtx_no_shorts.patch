diff -Naur src/sfnt/ttmtx.c.orig src/sfnt/ttmtx.c
--- src/sfnt/ttmtx.c.orig	2009-06-20 12:47:07.000000000 +0200
+++ src/sfnt/ttmtx.c	2009-06-20 12:47:50.000000000 +0200
@@ -176,7 +176,7 @@
     }
 
     if ( FT_QNEW_ARRAY( *longs,  num_longs  ) ||
-         FT_QNEW_ARRAY( *shorts, num_shorts ) )
+         (num_shorts > 0 && FT_QNEW_ARRAY( *shorts, num_shorts ) ) )
       goto Fail;
 
     if ( FT_FRAME_ENTER( table_len ) )
